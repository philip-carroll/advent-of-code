import matplotlib.pyplot as plt
import networkx as nx
import collections
import more_itertools

highest = 1
chamber_width = 7
shapes = [
    [(0, 0), (1, 0), (2, 0), (3, 0)],  # horizontal line
    [(1, 0), (0, 1), (1, 1), (2, 1), (1, 2)],  # cross
    [(0, 0), (1, 0), (2, 0), (2, 1), (2, 2)],  # L shape
    [(0, 0), (0, 1), (0, 2), (0, 3)],  # vertical line
    [(0, 0), (1, 0), (1, 1), (0, 1)]  # square
]
colours = ['blue', 'orange', 'green', 'red', 'black']


class Block:
    shape = []

    def __init__(self, shape, colour, shape_idx):
        gap = (highest + 4) - min([y for (x, y) in shape])
        self.shape = [(x + 2, y + gap) for (x, y) in shape]
        self.settled = False
        self.colour = colour
        self.shape_idx = shape_idx

    def bottom(self):
        return min([y for (x, y) in self.shape])

    def top(self):
        return max([y for (x, y) in self.shape])

    def left(self):
        return min([x for (x, y) in self.shape])

    def right(self):
        return max([x for (x, y) in self.shape])

    def moveDown(self, blocks):
        new = [(x, y - 1) for (x, y) in self.shape]
        for block in blocks:
            a = set(new)
            b = set(block.shape)
            if a.intersection(b):
                self.settled = True
                return

        self.shape = new

        if self.bottom() == 1:
            self.settled = True

    def moveLeft(self, blocks):
        if self.left() > 0:
            new = [(x - 1, y) for (x, y) in self.shape]
            for block in blocks:
                a = set(new)
                b = set(block.shape)
                if a.intersection(b):
                    return

            self.shape = new

    def moveRight(self, blocks):
        if self.right() < 6:
            new = [(x + 1, y) for (x, y) in self.shape]
            for block in blocks:
                a = set(new)
                b = set(block.shape)
                if a.intersection(b):
                    return

            self.shape = new


def jet_pattern():
    with open(__file__.replace('.py', '.txt')) as f:
        pattern = list(f.readline().rstrip())
        pattern.reverse()
        return pattern


def driver():
    global highest
    jet = jet_pattern()
    blocks = []
    S = []
    last_block = None
    pattern = [
        (1, 1, 3), (2, 2, 3), (3, 4, 4), (4, 0, -6), (0, 0, 1), (1, 2, 7), (2, 2, 3), (3, 1, -6), (4, 4, -7),
        (0, 2, 14), (1, 2, 3), (2, 0, 2), (3, 3, 2), (4, 5, -5), (0, 2, 6), (1, 4, 3), (2, 1, 0), (3, 4, 3), (4, 4, 2),
        (0, 0, -4), (1, 4, 7), (2, 0, -4), (3, 0, 2), (4, 3, 3), (0, 2, 1), (1, 4, 3), (2, 2, 2), (3, 0, -5), (4, 4, 7),
        (0, 1, 1), (1, 1, 3), (2, 3, 2), (3, 6, -7), (4, 1, 7), (0, 1, 1), (1, 2, 3), (2, 2, 3), (3, 2, 2), (4, 2, 2),
        (0, 3, 1), (1, 1, 2), (2, 3, 2), (3, 1, -33), (4, 2, 33), (0, 1, 1), (1, 3, 3), (2, 4, 3), (3, 0, -32),
        (4, 2, 30), (0, 2, 1), (1, 1, 3), (2, 4, 1), (3, 5, 2), (4, 2, -1), (0, 3, 2), (1, 1, 2), (2, 4, 1), (3, 1, 2),
        (4, 1, 2), (0, 1, 1), (1, 4, 2), (2, 2, 2), (3, 2, 2), (4, 3, 0), (0, 2, 1), (1, 0, 2), (2, 4, 1), (3, 4, 2),
        (4, 1, -1), (0, 3, 2), (1, 0, 1), (2, 0, 3), (3, 3, 0), (4, 2, 2), (0, 1, 1), (1, 2, 3), (2, 4, 2), (3, 2, 1),
        (4, 5, 1), (0, 0, 0), (1, 4, 3), (2, 2, 2), (3, 2, 2), (4, 3, 0), (0, 3, 1), (1, 0, 1), (2, 0, 3), (3, 2, 4),
        (4, 0, -4), (0, 2, 5), (1, 1, 3), (2, 0, 3), (3, 2, 4), (4, 4, -8), (0, 3, 1), (1, 4, 3), (2, 2, 7), (3, 2, 2),
        (4, 3, 0), (0, 2, 1), (1, 4, 3), (2, 1, 0), (3, 1, 2), (4, 0, 2), (0, 0, 1), (1, 3, 2), (2, 4, 3), (3, 1, -1),
        (4, 2, -1), (0, 2, 1), (1, 4, 3), (2, 2, 2), (3, 2, 2), (4, 3, 0), (0, 3, 1), (1, 2, 3), (2, 2, 3), (3, 2, 2),
        (4, 2, 2), (0, 1, 1), (1, 0, 3), (2, 0, 3), (3, 3, -2), (4, 2, 4), (0, 0, 1), (1, 3, 2), (2, 4, 3), (3, 2, -1),
        (4, 1, 2), (0, 1, 1), (1, 2, 3), (2, 0, 2), (3, 3, 2), (4, 2, 2), (0, 2, 1), (1, 2, 3), (2, 4, 2), (3, 1, -8),
        (4, 1, 7), (0, 2, 1), (1, 2, 3), (2, 4, 2), (3, 4, 2), (4, 1, -3), (0, 2, 4), (1, 4, 3), (2, 1, 0), (3, 0, -19),
        (4, 2, 21), (0, 0, 1), (1, 3, 2), (2, 4, 3), (3, 0, -1), (4, 5, 3), (0, 2, 1), (1, 1, 3), (2, 0, 3), (3, 1, 2),
        (4, 2, 0), (0, 3, 1), (1, 2, 3), (2, 2, 3), (3, 4, 4), (4, 2, -4), (0, 0, 1), (1, 1, 3), (2, 0, 3), (3, 5, -9),
        (4, 4, 8), (0, 2, 2), (1, 1, 3), (2, 3, 0), (3, 2, 4), (4, 2, 2), (0, 2, 1), (1, 2, 3), (2, 1, 3), (3, 2, 2),
        (4, 2, 2), (0, 2, 1), (1, 1, 3), (2, 0, 3), (3, 0, 2), (4, 2, 0), (0, 3, 1), (1, 2, 3), (2, 4, 2), (3, 4, 2),
        (4, 2, -2), (0, 1, 3), (1, 2, 3), (2, 2, 3), (3, 4, 4), (4, 0, -8), (0, 0, 3), (1, 3, 8), (2, 4, 3), (3, 3, 0),
        (4, 1, -9), (0, 1, 10), (1, 2, 3), (2, 0, 2), (3, 4, 1), (4, 4, 2), (0, 0, -2), (1, 2, 4), (2, 2, 3), (3, 3, 2),
        (4, 2, 2), (0, 2, 1), (1, 0, 2), (2, 0, 3), (3, 5, -1), (4, 0, 1), (0, 1, 1), (1, 2, 3), (2, 4, 2), (3, 0, -2),
        (4, 2, 2), (0, 2, 1), (1, 2, 3), (2, 4, 2), (3, 4, 2), (4, 2, -2), (0, 2, 3), (1, 2, 3), (2, 1, 3), (3, 2, 2),
        (4, 0, -2), (0, 0, 3), (1, 2, 3), (2, 4, 2), (3, 0, -1), (4, 2, 1), (0, 2, 1), (1, 2, 3), (2, 2, 3), (3, 0, -4),
        (4, 4, 6), (0, 3, 1), (1, 2, 3), (2, 2, 3), (3, 0, -9), (4, 5, 5), (0, 0, 3), (1, 4, 3), (2, 0, 0), (3, 2, 4),
        (4, 0, -4), (0, 3, 1), (1, 0, 5), (2, 2, 2), (3, 0, 1), (4, 0, 2), (0, 1, -2), (1, 2, 3), (2, 4, 2), (3, 1, 1),
        (4, 2, -1), (0, 2, 1), (1, 1, 3), (2, 0, 3), (3, 2, 4), (4, 2, 2), (0, 0, 1), (1, 3, 2), (2, 4, 3), (3, 0, -1),
        (4, 4, 1), (0, 1, 1), (1, 2, 3), (2, 0, 2), (3, 3, 2), (4, 2, 2), (0, 2, 1), (1, 0, 2), (2, 0, 3), (3, 4, -1),
        (4, 2, 3), (0, 0, 1), (1, 3, 2), (2, 3, 3), (3, 2, -1), (4, 1, 2), (0, 3, 0), (1, 2, 3), (2, 0, 2), (3, 5, -1),
        (4, 3, 1), (0, 2, 1), (1, 2, 3), (2, 0, 2), (3, 5, -1), (4, 2, 3), (0, 3, 1), (1, 1, 2), (2, 0, 3), (3, 3, 0),
        (4, 2, 2), (0, 1, 1), (1, 2, 3), (2, 2, 3), (3, 0, -7), (4, 2, 7), (0, 1, 1), (1, 0, 3), (2, 4, 0), (3, 0, 3),
        (4, 3, -3), (0, 2, 1), (1, 2, 3), (2, 2, 3), (3, 1, -3), (4, 1, 3), (0, 1, 1), (1, 4, 2), (2, 4, 3), (3, 4, 2),
        (4, 5, 0), (0, 2, 1), (1, 2, 3), (2, 2, 3), (3, 4, 4), (4, 4, 2), (0, 2, 1), (1, 0, 2), (2, 2, 2), (3, 4, 4),
        (4, 1, -4), (0, 2, 5), (1, 2, 3), (2, 1, 3), (3, 1, 2), (4, 2, 0), (0, 3, 1), (1, 0, 2), (2, 3, 1), (3, 0, 2),
        (4, 5, 0), (0, 2, 1), (1, 2, 3), (2, 0, 2), (3, 2, 4), (4, 0, -4), (0, 3, -1), (1, 3, 3), (2, 4, 3), (3, 2, 3),
        (4, 1, 2), (0, 3, -4), (1, 3, 3), (2, 2, 4), (3, 3, 2), (4, 1, -2), (0, 1, 3), (1, 2, 3), (2, 0, 2), (3, 4, 1),
        (4, 0, -1), (0, 2, 2), (1, 0, 2), (2, 3, 1), (3, 3, 2), (4, 0, -1), (0, 0, 2), (1, 2, 3), (2, 1, 3), (3, 4, -7),
        (4, 4, 5), (0, 1, 3), (1, 0, 3), (2, 0, 3), (3, 5, -5), (4, 5, 2), (0, 3, 1), (1, 4, 3), (2, 1, 2), (3, 2, 2),
        (4, 4, -2), (0, 1, 3), (1, 2, 3), (2, 2, 3), (3, 1, -2), (4, 2, 2), (0, 3, 1), (1, 1, 2), (2, 2, 3), (3, 2, 2),
        (4, 2, 2), (0, 2, 1), (1, 4, 3), (2, 1, 0), (3, 2, 2), (4, 0, -2), (0, 1, 3), (1, 4, 2), (2, 4, 3), (3, 3, -1),
        (4, 3, 2), (0, 2, 1), (1, 0, 2), (2, 3, 1), (3, 2, 2), (4, 2, 2), (0, 0, 1), (1, 2, 3), (2, 1, 3), (3, 0, -2),
        (4, 2, 4), (0, 1, 1), (1, 2, 3), (2, 2, 3), (3, 2, 2), (4, 1, 2), (0, 0, 1), (1, 3, 2), (2, 0, 1), (3, 2, 4),
        (4, 1, 2), (0, 2, 1), (1, 2, 3), (2, 1, 3), (3, 2, 2), (4, 5, -6), (0, 3, 5), (1, 3, 3), (2, 0, 1), (3, 2, 4),
        (4, 4, -3), (0, 3, 1), (1, 0, 4), (2, 2, 2), (3, 2, 2), (4, 2, 2), (0, 0, 1), (1, 0, 3), (2, 2, 2), (3, 5, -12),
        (4, 1, 12), (0, 3, 1), (1, 2, 3), (2, 2, 3), (3, 3, 2), (4, 1, -7), (0, 3, 8), (1, 2, 3), (2, 4, 2), (3, 3, 2),
        (4, 0, -13), (0, 2, 14), (1, 2, 3), (2, 0, 2), (3, 2, 4), (4, 0, -4), (0, 3, -1), (1, 4, 3), (2, 2, 5),
        (3, 4, 4), (4, 2, -4), (0, 0, 1), (1, 4, 5), (2, 1, -2), (3, 2, 2), (4, 0, -2), (0, 1, 3), (1, 3, 3), (2, 4, 3),
        (3, 3, 0), (4, 0, -4), (0, 2, 5), (1, 4, 3), (2, 2, 2), (3, 2, 2), (4, 2, 2), (0, 3, 1), (1, 4, 3), (2, 4, 3),
        (3, 2, -3), (4, 2, 2), (0, 0, 1), (1, 4, 2), (2, 2, 2), (3, 1, 0), (4, 0, 2), (0, 3, -1), (1, 0, 4), (2, 4, -1),
        (3, 0, 4), (4, 0, 2), (0, 1, -4), (1, 4, 2), (2, 3, 3), (3, 3, 2), (4, 2, 2), (0, 1, 1), (1, 2, 3), (2, 2, 3),
        (3, 1, -2), (4, 2, 2), (0, 0, 1), (1, 3, 2), (2, 0, 1), (3, 2, 4), (4, 0, -4), (0, 2, 5), (1, 2, 3), (2, 1, 3),
        (3, 4, 0), (4, 4, 2), (0, 1, 1), (1, 2, 3), (2, 2, 3), (3, 1, -2), (4, 2, 2), (0, 2, 1), (1, 0, 2), (2, 2, 2),
        (3, 0, 1), (4, 1, -1), (0, 2, 1), (1, 3, 3), (2, 2, 3), (3, 3, 2), (4, 5, -4), (0, 0, 5), (1, 3, 2), (2, 2, 3),
        (3, 1, -1), (4, 1, 2), (0, 3, 0), (1, 2, 3), (2, 2, 3), (3, 3, 2), (4, 2, 2), (0, 1, 1), (1, 4, 2), (2, 2, 2),
        (3, 3, 2), (4, 2, 2), (0, 0, 1), (1, 2, 3), (2, 0, 2), (3, 4, 1), (4, 4, 2), (0, 0, -2), (1, 4, 5), (2, 3, 3),
        (3, 4, 2), (4, 2, -8), (0, 1, 9), (1, 4, 2), (2, 1, 1), (3, 5, 3), (4, 1, -3), (0, 0, 1), (1, 2, 3), (2, 0, 2),
        (3, 5, 1), (4, 3, -1), (0, 3, 2), (1, 1, 2), (2, 3, 2), (3, 2, 2), (4, 3, -2), (0, 1, 3), (1, 2, 3), (2, 2, 3),
        (3, 1, -13), (4, 0, 9), (0, 0, 3), (1, 0, 3), (2, 0, 3), (3, 6, -14), (4, 0, 14), (0, 2, 1), (1, 4, 3),
        (2, 0, 0), (3, 2, 4), (4, 1, 2), (0, 2, 1), (1, 1, 3), (2, 3, 2), (3, 3, 2), (4, 0, -3), (0, 3, 4), (1, 0, -1),
        (2, 0, 3), (3, 4, 2), (4, 1, 0), (0, 0, 1), (1, 0, 3), (2, 3, 0), (3, 3, 2), (4, 4, 0), (0, 1, 1), (1, 4, 2),
        (2, 4, 3), (3, 3, -1), (4, 0, -2), (0, 1, 3), (1, 3, 3), (2, 0, 0), (3, 2, 4), (4, 0, -4), (0, 0, 5), (1, 0, 3),
        (2, 2, 2), (3, 0, 1), (4, 3, 1), (0, 0, 1), (1, 0, 3), (2, 2, 0), (3, 2, 3), (4, 2, 2), (0, 1, 1), (1, 0, 3),
        (2, 2, 0), (3, 4, -21), (4, 2, 22), (0, 2, 1), (1, 1, 3), (2, 0, 3), (3, 3, 0), (4, 5, -4), (0, 2, 5),
        (1, 2, 3), (2, 4, 2), (3, 4, 2), (4, 0, -8), (0, 3, 9), (1, 1, 2), (2, 0, 3), (3, 5, -1), (4, 2, 3), (0, 3, 1),
        (1, 4, 3), (2, 0, -1), (3, 3, 2), (4, 1, 0), (0, 0, 1), (1, 2, 3), (2, 2, 3), (3, 3, 2), (4, 1, -2), (0, 2, 3),
        (1, 1, 3), (2, 3, 0), (3, 5, -10), (4, 2, 12), (0, 3, 1), (1, 2, 3), (2, 2, 3), (3, 2, 2), (4, 4, 0), (0, 3, 1),
        (1, 1, 2), (2, 3, 2), (3, 4, 2), (4, 2, -2), (0, 2, 3), (1, 1, 3), (2, 0, 3), (3, 2, 4), (4, 4, -8), (0, 2, 9),
        (1, 1, 3), (2, 2, 3), (3, 3, 2), (4, 2, 2), (0, 0, 1), (1, 3, 2), (2, 2, 3), (3, 4, 4), (4, 1, -4), (0, 2, 5),
        (1, 1, 3), (2, 2, 3), (3, 4, 4), (4, 0, -6), (0, 3, 7), (1, 1, 2), (2, 3, 2), (3, 4, 2), (4, 2, -2), (0, 0, 1),
        (1, 1, 3), (2, 2, 3), (3, 2, 2), (4, 0, -4), (0, 0, 5), (1, 2, 3), (2, 4, 2), (3, 0, -1), (4, 3, 1), (0, 1, 1),
        (1, 3, 3), (2, 0, 0), (3, 1, 2), (4, 4, 0), (0, 1, 1), (1, 2, 3), (2, 4, 2), (3, 6, 4), (4, 1, -5), (0, 0, 1),
        (1, 1, 3), (2, 0, 3), (3, 4, -4), (4, 4, 2), (0, 1, 3), (1, 2, 3), (2, 0, 2), (3, 3, 2), (4, 1, 0), (0, 3, 1),
        (1, 1, 2), (2, 2, 3), (3, 4, 4), (4, 1, -4), (0, 2, 5), (1, 2, 3), (2, 2, 3), (3, 4, 4), (4, 2, -13),
        (0, 2, 14), (1, 4, 3), (2, 3, 3), (3, 6, 0), (4, 1, -4), (0, 3, 5), (1, 2, 3), (2, 0, 2), (3, 3, 2), (4, 4, -3),
        (0, 2, 4), (1, 1, 3), (2, 3, 0), (3, 2, 4), (4, 1, 2), (0, 1, 1), (1, 0, 3), (2, 3, 0), (3, 0, 3), (4, 2, -2),
        (0, 2, 1), (1, 0, 3), (2, 3, 0), (3, 1, 4), (4, 2, -3), (0, 2, 1), (1, 0, 5), (2, 2, 2), (3, 1, 2), (4, 2, -2),
        (0, 0, 3), (1, 3, 0), (2, 2, 3), (3, 4, 4), (4, 1, -4), (0, 1, 5), (1, 2, 3), (2, 2, 3), (3, 3, 2), (4, 0, -6),
        (0, 1, 7), (1, 2, 3), (2, 0, 2), (3, 4, 1), (4, 2, 1), (0, 1, 1), (1, 2, 3), (2, 4, 2), (3, 0, -6), (4, 2, 6),
        (0, 0, 1), (1, 2, 3), (2, 2, 3), (3, 4, 4), (4, 1, -4), (0, 2, 5), (1, 2, 3), (2, 2, 3), (3, 2, -7), (4, 1, 7),
        (0, 1, 1), (1, 2, 3), (2, 2, 3), (3, 1, -2), (4, 4, 4), (0, 2, 1), (1, 2, 3), (2, 3, 3), (3, 2, 0), (4, 4, 2),
        (0, 3, 1), (1, 2, 3), (2, 2, 3), (3, 1, -32), (4, 4, 34), (0, 2, 1), (1, 0, 2), (2, 2, 2), (3, 2, 2),
        (4, 5, -4), (0, 2, 5), (1, 3, 3), (2, 1, 2), (3, 2, 2), (4, 0, -2), (0, 2, 3), (1, 4, 3), (2, 1, 0), (3, 1, 2),
        (4, 2, 0), (0, 1, 1), (1, 2, 3), (2, 0, 2), (3, 5, -4), (4, 0, 4), (0, 3, -1), (1, 2, 3), (2, 4, 2), (3, 1, 0),
        (4, 2, 0), (0, 2, 1), (1, 4, 3), (2, 2, 2), (3, 4, 4), (4, 1, -4), (0, 3, 5), (1, 1, 2), (2, 4, 1), (3, 3, 2),
        (4, 5, 0), (0, 1, 1), (1, 4, 2), (2, 4, 3), (3, 1, -1), (4, 3, 1), (0, 1, 1), (1, 2, 3), (2, 2, 3), (3, 2, 2),
        (4, 2, 2), (0, 0, 1), (1, 3, 2), (2, 1, 2), (3, 2, 2), (4, 0, -2), (0, 0, 3), (1, 3, 2), (2, 2, 3), (3, 4, 4),
        (4, 1, -4), (0, 2, 5), (1, 4, 3), (2, 1, 0), (3, 2, 2), (4, 1, 2), (0, 2, 1), (1, 0, 2), (2, 2, 2), (3, 2, 2),
        (4, 1, 2), (0, 2, 1), (1, 3, 3), (2, 4, 3), (3, 1, -9), (4, 2, 7), (0, 3, 3), (1, 1, 2), (2, 2, 3), (3, 1, 0),
        (4, 0, 2), (0, 2, -1), (1, 4, 3), (2, 0, 1), (3, 2, 4), (4, 2, 2), (0, 0, 1), (1, 2, 3), (2, 0, 2), (3, 6, -10),
        (4, 4, 9), (0, 2, 2), (1, 0, 2), (2, 4, 1), (3, 1, 3), (4, 3, -3), (0, 0, 4), (1, 3, 2), (2, 2, 3), (3, 2, 2),
        (4, 1, 2), (0, 2, 1), (1, 1, 3), (2, 3, 2), (3, 1, -11), (4, 2, 11), (0, 1, 1), (1, 2, 3), (2, 3, 3),
        (3, 6, -22), (4, 1, 20), (0, 3, 3), (1, 3, 3), (2, 1, 2), (3, 2, 2), (4, 0, -2), (0, 0, 3), (1, 2, 3),
        (2, 0, 2), (3, 5, -7), (4, 4, 2), (0, 0, 6), (1, 3, 2), (2, 3, 3), (3, 3, 2), (4, 5, 0), (0, 0, 1), (1, 3, 2),
        (2, 4, 3), (3, 3, 0), (4, 1, -3), (0, 0, 4), (1, 0, 3), (2, 2, 2), (3, 0, 1), (4, 2, -1), (0, 3, 1), (1, 2, 3),
        (2, 4, 2), (3, 0, -1), (4, 0, 2), (0, 0, 1), (1, 0, 3), (2, 2, 0), (3, 0, 3), (4, 3, -1), (0, 3, 1), (1, 4, 3),
        (2, 2, 2), (3, 2, 2), (4, 0, -5), (0, 3, 4), (1, 2, 3), (2, 0, 2), (3, 4, 1), (4, 4, 2), (0, 0, -2), (1, 0, 3),
        (2, 3, 2), (3, 0, 1), (4, 3, -1), (0, 0, 2), (1, 0, 3), (2, 2, 0), (3, 0, 3), (4, 0, 2), (0, 0, 1), (1, 0, 3),
        (2, 0, 3), (3, 4, -8), (4, 4, 2), (0, 2, 7), (1, 0, 2), (2, 0, 3), (3, 5, -19), (4, 3, 16), (0, 2, 4),
        (1, 2, 3), (2, 2, 3), (3, 0, -5), (4, 2, 5), (0, 0, 1), (1, 1, 3), (2, 2, 3), (3, 1, 0), (4, 0, 2), (0, 0, 1),
        (1, 2, 3), (2, 2, 3), (3, 1, -2), (4, 1, 2), (0, 2, 1), (1, 2, 3), (2, 4, 2), (3, 1, -2), (4, 0, 2), (0, 1, 1),
        (1, 2, 3), (2, 0, 2), (3, 3, 2), (4, 4, -3), (0, 2, 4), (1, 2, 3), (2, 2, 3), (3, 4, 4), (4, 4, 2), (0, 0, -7),
        (1, 3, 10), (2, 4, 3), (3, 4, 2), (4, 2, -13), (0, 1, 14), (1, 0, 3), (2, 2, 0), (3, 0, 3), (4, 2, -2),
        (0, 0, 3), (1, 3, 2), (2, 4, 3), (3, 0, -1), (4, 5, 3), (0, 2, 1), (1, 0, 2), (2, 3, 1), (3, 1, 3), (4, 3, -3),
        (0, 0, 4), (1, 3, 2), (2, 1, 2), (3, 1, 2), (4, 2, 0), (0, 3, 1), (1, 2, 3), (2, 3, 3), (3, 0, -9), (4, 4, 11),
        (0, 2, 1), (1, 2, 3), (2, 0, 2), (3, 4, 1), (4, 2, 1), (0, 0, 1), (1, 4, 0), (2, 3, 3), (3, 2, 1), (4, 3, -1),
        (0, 2, 2), (1, 1, 3), (2, 2, 3), (3, 1, 0), (4, 0, 2), (0, 0, 1), (1, 3, 2), (2, 4, 3), (3, 2, -1), (4, 3, 1),
        (0, 2, 1), (1, 2, 3), (2, 0, 2), (3, 4, 1), (4, 2, 1), (0, 2, 1), (1, 1, 3), (2, 2, 3), (3, 2, 2), (4, 2, 2),
        (0, 2, 1), (1, 2, 3), (2, 3, 3), (3, 2, 0), (4, 2, 2), (0, 0, 1), (1, 3, 2), (2, 2, 3), (3, 1, -1), (4, 4, 3),
        (0, 2, 1), (1, 0, 2), (2, 1, 3), (3, 5, -1), (4, 1, 1), (0, 1, 1), (1, 2, 3), (2, 1, 3), (3, 2, 2), (4, 0, -2),
        (0, 0, 3), (1, 3, 2), (2, 2, 3), (3, 4, -8), (4, 5, 6), (0, 1, 3), (1, 3, 3), (2, 3, 3), (3, 1, -2), (4, 3, 2),
        (0, 1, 1), (1, 1, 3), (2, 2, 3), (3, 3, 2), (4, 1, -2), (0, 0, 3), (1, 2, 3), (2, 2, 3), (3, 2, 2), (4, 1, 2),
        (0, 2, 1), (1, 4, 3), (2, 1, 0), (3, 0, -10), (4, 0, 10), (0, 2, 1), (1, 0, 2), (2, 2, 2), (3, 4, 4),
        (4, 0, -4), (0, 2, 5), (1, 2, 3), (2, 2, 3), (3, 4, 4), (4, 2, -4), (0, 3, 5), (1, 3, 3), (2, 1, 2), (3, 1, 2),
        (4, 1, 2), (0, 1, 1), (1, 3, 3), (2, 0, 0), (3, 5, 3), (4, 3, -1), (0, 0, 1), (1, 2, 3), (2, 2, 3), (3, 0, -2),
        (4, 1, 2), (0, 1, 1), (1, 0, 3), (2, 3, 0), (3, 3, 2), (4, 1, 0), (0, 0, 1), (1, 2, 3), (2, 2, 3), (3, 4, 4),
        (4, 2, -4), (0, 0, 1), (1, 4, 5), (2, 1, -2), (3, 1, 2), (4, 2, 0), (0, 2, 1), (1, 2, 3), (2, 2, 3), (3, 4, 4),
        (4, 1, -4), (0, 0, 1), (1, 1, 3), (2, 4, 3), (3, 0, -2), (4, 2, 1), (0, 2, 1), (1, 1, 3), (2, 0, 3), (3, 3, 0),
        (4, 4, -4), (0, 2, 5), (1, 0, 2), (2, 3, 1), (3, 2, 2), (4, 2, 2), (0, 3, 1), (1, 1, 2), (2, 2, 3), (3, 1, 0),
        (4, 4, 2), (0, 3, 1), (1, 2, 3), (2, 2, 3), (3, 2, 2), (4, 0, -9), (0, 2, 10), (1, 0, 2), (2, 4, 1), (3, 4, 2),
        (4, 2, -2), (0, 3, 3), (1, 1, 2), (2, 2, 3), (3, 4, 4), (4, 2, -4), (0, 0, 1), (1, 2, 5), (2, 0, 2), (3, 2, 4),
        (4, 5, -15), (0, 2, 16), (1, 0, 2), (2, 4, 1), (3, 3, 1), (4, 1, 0), (0, 0, 1), (1, 3, 2), (2, 2, 3), (3, 3, 2),
        (4, 4, 0), (0, 0, 1), (1, 2, 3), (2, 2, 3), (3, 0, -2), (4, 1, 2), (0, 1, 1), (1, 0, 3), (2, 0, 3), (3, 3, -2),
        (4, 4, -2), (0, 3, 3), (1, 0, 3), (2, 0, 3), (3, 5, -2), (4, 2, 4), (0, 2, 1), (1, 2, 3), (2, 3, 3), (3, 1, -7),
        (4, 3, 7), (0, 2, 1), (1, 4, 3), (2, 2, 2), (3, 4, 4), (4, 1, -7), (0, 2, 8), (1, 1, 3), (2, 1, 3), (3, 4, -2),
        (4, 2, 4), (0, 1, 1), (1, 0, 3), (2, 3, 0), (3, 4, 2), (4, 2, -1), (0, 3, 2), (1, 4, 3), (2, 1, 0), (3, 0, -3),
        (4, 2, 5), (0, 2, 1), (1, 4, 3), (2, 2, 2), (3, 3, 2), (4, 2, 2), (0, 0, 1), (1, 0, 3), (2, 4, -5), (3, 2, 8),
        (4, 0, -1), (0, 3, -4), (1, 4, 3), (2, 3, 3), (3, 6, 0), (4, 1, 1), (0, 2, 1), (1, 1, 3), (2, 0, 3), (3, 1, 2),
        (4, 2, 0), (0, 0, 1), (1, 0, 3), (2, 3, 0), (3, 1, 4), (4, 2, -3), (0, 1, 4), (1, 3, 3), (2, 2, 3), (3, 4, 4),
        (4, 4, 2), (0, 0, -7), (1, 4, 10), (2, 4, 3), (3, 4, 2), (4, 4, 2), (0, 1, -7), (1, 2, 9), (2, 2, 3), (3, 2, 2),
        (4, 1, 2), (0, 1, 1), (1, 0, 3), (2, 2, 2), (3, 0, 1), (4, 0, 2), (0, 1, -2), (1, 3, 3), (2, 2, 3), (3, 1, 0),
        (4, 1, 2), (0, 0, 1), (1, 3, 2), (2, 1, 2), (3, 1, 2), (4, 2, 0), (0, 2, 1), (1, 1, 3), (2, 2, 3), (3, 2, 2),
        (4, 5, -6), (0, 2, 7), (1, 4, 3), (2, 4, 3), (3, 1, -9), (4, 1, 5), (0, 1, 1), (1, 2, 3), (2, 2, 3), (3, 3, 2),
        (4, 0, -6), (0, 1, 7), (1, 3, 3), (2, 3, 3), (3, 2, -2), (4, 3, 2), (0, 0, 1), (1, 3, 2), (2, 1, 2), (3, 2, 2),
        (4, 4, -2), (0, 2, 3), (1, 2, 3), (2, 4, 2), (3, 1, -6), (4, 2, 6), (0, 1, 1), (1, 4, 2), (2, 1, 1), (3, 1, 2),
        (4, 1, 2), (0, 3, -3), (1, 2, 5), (2, 0, 2), (3, 1, 2), (4, 0, 2), (0, 3, -5), (1, 3, 3), (2, 2, 3), (3, 0, 3),
        (4, 5, -5), (0, 2, 3), (1, 0, 4), (2, 2, 2), (3, 4, 4), (4, 2, -4), (0, 0, 1), (1, 2, 5), (2, 2, 3), (3, 4, 4),
        (4, 1, -4), (0, 3, 5), (1, 1, 2), (2, 3, 2), (3, 2, 2), (4, 1, 2), (0, 3, -3), (1, 3, 3), (2, 2, 3), (3, 3, 2),
        (4, 0, -3), (0, 2, 4), (1, 2, 3), (2, 4, 2), (3, 0, -5), (4, 4, 5), (0, 3, 1), (1, 1, -1), (2, 2, 4),
        (3, 1, -1), (4, 2, 1), (0, 3, 1), (1, 1, 2), (2, 4, 1), (3, 0, -9), (4, 3, 9), (0, 2, 1), (1, 2, 3), (2, 0, 2),
        (3, 0, 2), (4, 1, 0), (0, 0, 1), (1, 0, 3), (2, 2, 2), (3, 4, 4), (4, 1, -4), (0, 1, 5), (1, 1, 3), (2, 4, 0),
        (3, 1, 3), (4, 2, -1), (0, 2, 1), (1, 2, 3), (2, 4, 2), (3, 1, -1), (4, 2, 1), (0, 2, 1), (1, 4, 3), (2, 2, 2),
        (3, 1, -3), (4, 0, 2), (0, 3, 2), (1, 1, 2), (2, 3, 2), (3, 2, 2), (4, 2, 2), (0, 0, 1), (1, 0, 3), (2, 2, 2),
        (3, 2, 2), (4, 2, 2), (0, 2, 1), (1, 4, 3), (2, 1, 0), (3, 0, -7), (4, 2, 9), (0, 1, 1), (1, 4, 2), (2, 4, 3),
        (3, 1, -1), (4, 1, 2), (0, 2, 1), (1, 4, 3), (2, 4, 3), (3, 3, -2), (4, 1, -2), (0, 0, 3), (1, 4, 3), (2, 4, 3),
        (3, 2, -2), (4, 3, 2), (0, 0, 1), (1, 4, 1), (2, 0, 2), (3, 1, 2), (4, 5, -2), (0, 2, 1), (1, 4, 3), (2, 3, 3),
        (3, 2, -2), (4, 2, 2), (0, 3, 1), (1, 1, 2), (2, 2, 3), (3, 1, -7), (4, 2, 7), (0, 1, 1), (1, 0, 3), (2, 2, 0),
        (3, 4, 4), (4, 4, 2), (0, 1, 1), (1, 2, 3), (2, 0, 2), (3, 2, 4), (4, 0, -4), (0, 3, -1), (1, 4, 3), (2, 0, 5),
        (3, 5, -1), (4, 2, 3), (0, 1, 1), (1, 4, 2), (2, 2, 2), (3, 1, 0), (4, 4, 2), (0, 2, 1), (1, 4, 3), (2, 2, 2),
        (3, 0, -13), (4, 4, 15), (0, 3, 1), (1, 1, 2), (2, 2, 3), (3, 3, 2), (4, 4, 0), (0, 2, 1), (1, 0, 2), (2, 2, 2),
        (3, 3, 2), (4, 0, -2), (0, 2, 3), (1, 1, 3), (2, 3, 2), (3, 3, 2), (4, 2, 2), (0, 2, 1), (1, 1, 3), (2, 3, 2),
        (3, 2, 2), (4, 1, 2), (0, 1, 1), (1, 4, 2), (2, 0, 1), (3, 5, 3), (4, 4, 2), (0, 0, -4), (1, 2, 6), (2, 1, 3),
        (3, 2, 2), (4, 0, -2), (0, 1, 3), (1, 2, 3), (2, 2, 3), (3, 0, -5), (4, 1, 5), (0, 2, 1), (1, 2, 3), (2, 0, 2),
        (3, 3, 2), (4, 2, 2), (0, 1, 1), (1, 3, 3), (2, 2, 3), (3, 1, -2), (4, 4, 4), (0, 2, 1), (1, 2, 3), (2, 2, 3),
        (3, 1, -7), (4, 4, 9), (0, 3, 1), (1, 1, 2), (2, 2, 3), (3, 2, 2), (4, 2, 2), (0, 2, 1), (1, 2, 3), (2, 2, 3),
        (3, 4, 4), (4, 4, 2), (0, 3, 1), (1, 1, 2), (2, 0, 3), (3, 2, 4), (4, 0, -4), (0, 2, 5), (1, 0, 2), (2, 4, 1),
        (3, 1, 3), (4, 3, -3), (0, 2, 1), (1, 0, 5), (2, 1, 3), (3, 1, 2), (4, 5, -8), (0, 1, 9), (1, 2, 3), (2, 4, 2),
        (3, 2, 1), (4, 0, -4), (0, 3, 4), (1, 2, 3), (2, 1, 3), (3, 5, -2), (4, 1, 2), (0, 2, 1), (1, 2, 3), (2, 4, 2),
        (3, 5, 2), (4, 3, -2), (0, 1, 1), (1, 3, 3), (2, 1, 2), (3, 1, 2), (4, 1, 2), (0, 2, 1), (1, 2, 3), (2, 2, 3),
        (3, 6, -13), (4, 4, 15), (0, 0, -3), (1, 1, 3), (2, 0, 3), (3, 2, 4), (4, 5, -5), (0, 0, 6), (1, 4, -3),
        (2, 2, 6), (3, 1, 1), (4, 1, 2), (0, 1, 1), (1, 0, 3), (2, 2, 2), (3, 2, 2), (4, 4, 0), (0, 0, 1), (1, 0, 3),
        (2, 0, 3), (3, 5, -3), (4, 4, 2), (0, 1, 2), (1, 2, 3), (2, 0, 2), (3, 2, 4), (4, 0, -4), (0, 3, -1), (1, 3, 3),
        (2, 3, 3), (3, 3, 2), (4, 0, -5), (0, 1, 6), (1, 4, 2), (2, 4, 3), (3, 3, -1), (4, 0, -2), (0, 3, 4), (1, 4, 3),
        (2, 2, 2), (3, 4, 4), (4, 2, -4), (0, 0, 1), (1, 1, 3), (2, 4, 3), (3, 3, 0), (4, 1, -1), (0, 2, 2), (1, 1, 3),
        (2, 2, 3), (3, 6, -3), (4, 1, 3), (0, 1, 1), (1, 2, 3), (2, 0, 2), (3, 6, -5), (4, 2, 7), (0, 1, 1), (1, 4, 2),
        (2, 2, 2), (3, 1, -5), (4, 2, 5), (0, 0, 1), (1, 3, 2), (2, 0, 1), (3, 2, 4), (4, 5, -4), (0, 3, 1), (1, 3, 3),
        (2, 0, 3), (3, 2, 4), (4, 2, 2), (0, 1, 1), (1, 4, 2), (2, 2, 2), (3, 1, -9), (4, 2, 9), (0, 1, 1), (1, 3, 3),
        (2, 0, 0), (3, 2, 4), (4, 0, -4), (0, 3, 1), (1, 1, 6), (2, 3, 2), (3, 4, -4), (4, 3, 4), (0, 1, 1), (1, 3, 3),
        (2, 2, 3), (3, 0, -12), (4, 1, 12), (0, 0, 1), (1, 0, 3), (2, 2, 0), (3, 4, 4), (4, 0, -2), (0, 3, 3),
        (1, 1, -1), (2, 1, 4), (3, 1, 2), (4, 2, 0), (0, 1, 1), (1, 3, 3), (2, 4, 3), (3, 0, -11), (4, 1, 7), (0, 2, 3),
        (1, 0, 2), (2, 0, 3), (3, 4, -1), (4, 1, 3), (0, 1, 1), (1, 2, 3), (2, 4, 2), (3, 0, -6), (4, 2, 6), (0, 2, 1),
        (1, 1, 3), (2, 0, 3), (3, 5, -2), (4, 4, 2), (0, 1, 1), (1, 2, 3), (2, 2, 3), (3, 3, 2), (4, 5, -7), (0, 2, 8),
        (1, 2, 3), (2, 2, 3), (3, 4, 4), (4, 1, -13), (0, 3, 14), (1, 2, 3), (2, 2, 3), (3, 0, -25), (4, 4, 27),
        (0, 2, 1),
    ]

    while True:
        for i in range(len(shapes)):
            block = Block(shapes[i], colours[i], i % 5)

            while not block.settled:
                if len(jet) == 0:
                    jet = jet_pattern()

                move = jet.pop()
                if move == '>':
                    block.moveRight(blocks)
                else:
                    block.moveLeft(blocks)

                block.moveDown(blocks)

            if block.top() > highest:
                highest = block.top()

            blocks.append(block)
            if last_block:
                S.append((block.shape_idx, block.left(), block.top() - last_block.top()))
            else:
                S.append((block.shape_idx, block.left(), 0))
            last_block = block

            print('Blocks: %s Height: %s' % (len(S), highest))

            if len(S) > 1705 and S[-1705:] == pattern:
                print('Height after iteration 1: %s' % highest)

            if len(S) > 3410 and S[-3410:] == pattern * 2:
                print('Height after iteration 2: %s' % str(highest))

            if len(S) > 5115 and S[-5115:] == pattern * 3:
                print('Height after iteration 3: %s' % str(highest))
                return blocks, S

            # if len(S) >= 5000:
            #     return blocks, S


def count_sequence(lst, seq):
    matches = set()
    count = 0
    len_seq = len(seq)
    upper_bound = len(lst) - len_seq + 1
    for i in range(upper_bound):
        cut = lst[i:i + len_seq]
        if cut == seq and i not in matches and (i + len_seq) not in matches:
            count += 1
            matches = matches.union(set(range(i, i + len_seq)))
    return count


if __name__ == '__main__':
    floor = [(x, 0) for x in range(chamber_width)]
    blocks, S = driver()

    for block in blocks:
        xs = [s[0] for s in block.shape]
        ys = [s[1] for s in block.shape]
        plt.plot(xs, ys, 'o', color=block.colour)
    plt.plot([x[0] for x in floor], [s[1] for s in floor], '-')
    plt.axis('scaled')

    print(S)
    size = 20  # int(len(S) / 2)

    # while size > 0:
    #     windows = [list(window) for window in more_itertools.windowed(S, size)]
    #     for window in windows:
    #         count = count_sequence(S, window)
    #         if count > 1:  # repeating pattern
    #             print('%s / %s / %s' % (size, count, window))
    #             a = window
    #             size = 0
    #             break
    #     size -= 1
    #     print(size)

    plt.show()
